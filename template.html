<style>
    .swiper-container {
        width: 100%;
        height: 100%;
    }
    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #fff;
        /* Center slide text vertically */
        display: -webkit-box;
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
    }
</style>
<div class="row skeleton">
    <div class="col-xs-12 col-sm-9">
        <h2 id="question">Â¿Ves el sello "Sin Gluten"?</h2>
        <!-- Swiper -->
        <div class="swiper-container">
            <div class="swiper-wrapper"></div>
            <!-- Add Pagination -->
            <div class="swiper-pagination"></div>
        </div>
    </div>
</div>
<div class="row skeleton">
    <div id="answer" class="top20 col-xs-12">
        <button class="btn btn-answer " value="Yes">Yes</button><button class="btn btn-answer " value="No">No</button>
    </div>
    <div class="top20 col-xs-12">
        <a id="photo-link" href="#">
            <img id="photo" src="http://i.imgur.com/GeHxzb7.png" style="max-width=100%">
        </a>
    </div>
</div>
<script type="text/javascript">
(function() {
// Default language
var userLocale = "en";
// Translations
var messages = {"en": {
                        "i18n_working_task": "Task",
                      },
                "es": {
                        "i18n_working_task": "Tarea",
                      },
               };
// Update userLocale with server side information
$(document).ready(function(){
    userLocale = document.getElementById('PYBOSSA_USER_LOCALE').textContent.trim();
});

function i18n_translate() {
    var ids = Object.keys(messages[userLocale])
    for (i=0; i<ids.length; i++) {
        console.log("Translating: " + ids[i]);
        document.getElementById(ids[i]).innerHTML = messages[userLocale][ids[i]];
    }
}

pybossa.taskLoaded(function(task, deferred) {
    if ( !$.isEmptyObject(task) ) {
        // load image from flickr
        var img = $('<img />');
        img.load(function() {
            // continue as soon as the image is loaded
            deferred.resolve(task);
        });
        img.attr('src', task.info.images[0]).css('height', 'auto');
        img.css('max-width', '100%');
        task.info.image = img;
    }
    else {
        deferred.resolve(task);
    }
});


pybossa.presentTask(function(task, deferred) {
    if ( !$.isEmptyObject(task) ) {
        //i18n_translate();
        //$('#photo-link').html('').append(task.info.image);
        //$("#photo-link").attr("href", task.info.link);
        for (i=0;i<task.info.images.length;i++) {
            var div = $("<div/>");
            div.addClass("swiper-slide");
            var img = $("<img/>");
            img.attr("src", task.info.images[i]);
            div.append(img);
            $(".swiper-wrapper").append(div);
        }

        var swiper = new Swiper('.swiper-container', {
                pagination: '.swiper-pagination',
                paginationClickable: true
            });

        $('.btn-answer').off('click').on('click', function(evt) {
            var $btn = $(this);
            var answer = $btn.attr("value");
            if (typeof answer != 'undefined') {
                pybossa.saveTask(task.id, answer).done(function() {
                    deferred.resolve();
                });
            }
            else {
                pybossaNotify('Unexpected type of answer.', true, 'error');
            }
        });
    }
    else {
        $(".skeleton").hide();
        pybossaNotify('You have contributed to all available tasks! Thanks!', true, 'info');
    }
});

pybossa.run('soytestproject1');
})();
</script>
